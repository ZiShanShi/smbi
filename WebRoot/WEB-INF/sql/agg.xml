<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sql PUBLIC "sql" "../config/sql.dtd" >

<sqls>
	<dataSpace name="themegroup">
		<sql name="getDimensionByCodeGroupId">
			select code from bi_dimension where groupid = '@{groupid}' and active = 'T'
		</sql>

		<sql name="getMeasurmentByCode">
			select * from bi_measurment where code in (@{code})
		</sql>

		<sql name="createTableTemplate">
			CREATE TABLE [dbo].[@{tableName}] (
			[id] nvarchar(32) NOT NULL PRIMARY KEY,
			[aggcode] nvarchar(256) NULL ,
			@{fields}
			)
		</sql>

		<sql name="aggGroupByTemplate">
			SELECT @{selectfield} from (
			SELECT  @{selectinfield} FROM @{aggtable} agg
			@{leftjion}
			WHERE aggcode = '@{aggcode}' and @{filter} and @{notnull} @{user}
			)
			a01
			@{groupby}

		</sql>

		<sql name="commonAggTemplate">

			SELECT  @{field} FROM @{aggtable} agg
			@{leftjion}
			WHERE aggcode = '@{aggcode}' and @{filter}

		</sql>


		<!-- territory -->

		<sql name="createCommonTableTemplate">
			CREATE TABLE [dbo].[@{tableName}] (
			@{fields}
			)
		</sql>

		<sql name="getOrganizationType">
			SELECT DISTINCT type from organization WHERE type not in ('admin', 'Commercial');
		</sql>

		<sql name="getUserByOrganization">
			SELECT * from organization WHERE loginName = '@{loginName}';
		</sql>

		<sql name="getparentidfromorganization">
			SELECT @{parentId},  type from organization WHERE  @{baseId} = '@{id}'
		</sql>

		<sql name="getBaseUserByOrganization">
			SELECT Parent@{baseId}, @{baseId} from organization WHERE type = '@{baseType}' and @{baseId} is not null
		</sql>

		<sql name="dropTable">
			drop table  @{table}
		</sql>
	</dataSpace>
</sqls>
